<!DOCTYPE html>
<html>
<head>
  <title>jsCHAT</title>
  <meta name="description" content="jsCHAT - jedyny słuszny komunikator!">
  <meta name="keywords" content="jsCHAT, czat, chat, komunikator, jedyny słuszny, jedyny słuszny wybór, messenger, czatuj, rozmawiaj">
  <meta charset="utf-8">
  <link rel="manifest" href="https://jschat.netlify.com/manifest.json">
  <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" integrity="sha384-5KZdSYqynSzIjQGS2M1O3HW6HVDBjfNx0v5Y2eQuE3vvQ9NTiiPK9/GWc0yYCrgw" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" integrity="sha384-JhLA+V+09q/ZaCZbmbUCVDiaef0jvAbClR7ds1HiJzvS7hNlgxmyzipwbuPQQY8i" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://jschat.netlify.com/style.css">
<script
  src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
  integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8="
  crossorigin="anonymous"></script>
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js" integrity="sha384-ZOED+d9HxogEQwD+jFvux96iGQR9TxfJO+mPF2ZS0TuKH6eWrmvPsDpO6I0OWdiX" crossorigin="anonymous"></script>
 <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="icon" type="image/png" href="https://jschat.netlify.com/logo.png"/>
</head>
<body>
  <div id="loader">
      <a class="btn-floating pulse yellow accent-2"><i class="material-icons black-text">hourglass_full</i></a>
    <p id="loadingStatus"> Proszę czekać...</p>
  </div>

  <div id="unlogged" class="hidden">
  <p class="center flow-text"><img src="logo.png" class="logo" title="jsCHAT&#13;Jedyny słuszny komunikator">Witaj na Jedynym Słusznym Czacie!</p>
  <p class="center">Aby korzystać z aplikacji, musisz być zalogowany.</p>
  <ul class="collapsible">
    <li class="active">
      <div class="collapsible-header lime accent-3"><i class="material-icons">account_circle</i>Logowanie</div>
      <div class="collapsible-body"><div class="row">
      <div class="col s12">
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">email</i>
          <input required id="login_email" type="email" class="validate" placeholder="Adres e-mail">
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">lock</i>
          <input required id="login_password" type="password" class="validate" placeholder="Hasło">
        </div>
      </div>
      <button class="btn right waves-effect" onclick="login()"><i class="material-icons">check</i> Zaloguj się</button>
      
    </div>
  </div>
  </div>
    </li>
    <li>
      <div class="collapsible-header blue accent-2"><i class="material-icons">person_add</i>Rejestracja</div>
      <div class="collapsible-body"><div class="row">
    <div class="col s12">
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">perm_identity</i>
          <input required id="nick" type="text" class="validate" placeholder="Nick">
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">email</i>
          <input required id="email" type="email" class="validate" placeholder="Adres e-mail">
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">lock</i>
          <input required id="password" type="password" class="validate" placeholder="Hasło">
        </div>
      </div>
      <button class="btn right waves-effect" onclick="register()"><i class="material-icons">check</i> Zarejestruj się</button>
      
    </div>
  </div></div>
    </li>
    <li>
      <div class="collapsible-header yellow accent-2"><i class="material-icons">security</i>Odzyskiwanie konta</div>
      <div class="collapsible-body"><div class="row">
      <div class="col s12">
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">email</i>
          <input required id="recovery_email" type="email" class="validate" placeholder="Adres e-mail">
        </div>
      </div>
      <button class="btn right waves-effect" onclick="password_reset()"><i class="material-icons">check</i> Resetuj hasło</button>
    </div>
  </div>
  </div>
    </li>
  </ul>
  <footer class="page-footer green darken-4">
          <div class="container">
            <div class="row">
              <div class="col l6 s12">
                <h5 class="white-text">jsCHAT</h5>
                <p class="grey-text text-lighten-4">Jedyny Słuszny Komunikator</p>
              </div>
              <div class="col l4 offset-l2 s12">
                <h5 class="white-text">Linki</h5>
                <ul>
                  <li><a class="grey-text text-lighten-3" href="https://github.com/PetrusTryb/jsCHAT/" target="_blank">Zobacz kod źródłowy</a></li>
                  <li><a class="grey-text text-lighten-3" href="https://github.com/PetrusTryb/jsCHAT/issues" target="_blank">Zgłoś błąd</a></li>
                  <li><a class="grey-text text-lighten-3" href="https://gamerhash.com/pl/ref/19EzBG3a" target="_blank">Zarabiaj na mocy swojego komputera</a></li>
                  <li><a class="grey-text text-lighten-3" href="javascript:location.reload(true)">Wymuś aktualizację strony</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="footer-copyright">
            <div class="container">
            © Piotr Trybisz 2019 - &infin;
            <a class="grey-text text-lighten-4 right" href="https://piotr-trybisz.000webhostapp.com/" target="_blank">O autorze</a>
            </div>
          </div>
        </footer>
  </div>
  <div id="logged" class="hidden">
    <ul id="dropdownAccount" class="dropdown-content">
  <li><a onclick="settings()" class="modal-trigger" href="#settings">Ustawienia</a></li>
  <li><a onclick="logOut()">Wyloguj się</a></li>
</ul>
    <nav>
    <div class="nav-wrapper blue accent-2">
      <a class="brand-logo"><img src="logo.png" class="small_logo" title="jsCHAT&#13;Jedyny słuszny komunikator"> <span id="title" class="flow-text"></span></a>
      <a data-target="mobile-nav" class="sidenav-trigger"><i class="material-icons">menu</i></a>
      <ul class="right hide-on-med-and-down">
      <li><a class="modal-trigger" href="#ranking" onclick="ranking()">Ranking <span class="new badge" data-badge-caption=". miejsce" id="ranking1"></span></a></li>
      <li id="editChannelTrigger1" class="hidden"><a class="modal-trigger" href="#editChannel" onclick="editChannelWindow()">Edytuj tą konwersację</a></li>
      <li><a class="dropdown-trigger" data-target="dropdownAccount">Moje konto<i class="material-icons right">arrow_drop_down</i></a></li>
      </ul>
    </div>
  </nav>

  <ul class="sidenav" id="mobile-nav">
    <li><div class="user-view">
      <div class="background teal">
        
      </div>
      <a><img class="circle" id="avatar"></a>
      <a><span class="white-text name" id="nickname"></span></a>
      <a><span class="white-text email" id="userEmail"></span></a>
    </div></li>
    <li><a class="modal-trigger" href="#ranking" onclick="ranking()">Ranking <span class="new badge" data-badge-caption=". miejsce" id="ranking2"></span></a></li>
    <li id="editChannelTrigger2" class="hidden"><a class="modal-trigger" href="#editChannel" onclick="editChannelWindow()">Edytuj tą konwersację</a></li>
    <li><div class="divider"></div></li>
    <li><a onclick="settings()" class="modal-trigger" href="#settings">Ustawienia</a></li>
    <li><a onclick="logOut()">Wyloguj się</a></li>
  </ul>
  </ul>
  <div id="channelSelector">
    <div class="fixed-action-btn">
  <a class="btn-floating btn-large green darken-4 modal-trigger" href="#createChannel" id="openCreate" onclick="createChannelWindow()">
    <i class="large material-icons">add</i>
  </a>
  <div class="tap-target yellow accent-2" data-target="openCreate" id="tapToCreate">
    <div class="tap-target-content">
      <h5>Chcesz utworzyć nową konwersację?</h5>
      <p>Kliknij tutaj!</p>
    </div>
  </div>
</div>
    <table class="centered highlight">
        <thead class="lime accent-3">
          <tr>
              <th>Nazwa</th>
              <th>Twoje uprawnienia</th>
          </tr>
        </thead>

        <tbody id="channelSelectorBody">
          
        </tbody>
      </table>
  </div>
  <div id="channelWindow" class="hidden">
    <div id="messages">
        <div class="progress"><div class="indeterminate"></div></div>
    </div>
    <div class="fixed-action-btn"><a id="openSend" class="btn-floating btn-large blue" onclick="actionSend(true);"><i class="large material-icons">add_comment</i></a></div>
    <div class="tap-target yellow accent-2" data-target="openSend" id="tapToWrite">
    <div class="tap-target-content">
      <h5>Naciśnij ten przycisk,</h5>
      <p>aby napisać wiadomość.</p>
    </div>
  </div>
    <div id="write" class="hidden">
      <textarea id="textedit"></textarea>
      <button class="btn waves-effect waves-dark yellow accent-2 black-text full-width" onclick="sendMessage()">Wyślij
    <i class="material-icons right">send</i>
  </button>
    </div>
  </div>
  </div>

  <!-- Modal Structure -->
  <div id="createChannel" class="modal modal-fixed-footer modal-fullscreen">
    <div class="modal-content">
      <h4>Tworzenie konwersacji</h4>
      <div class="row">
        <div class="input-field col s12">

          <i class="material-icons prefix">edit_mode</i>
          <input required id="chan_name" type="text" class="validate">
          <label for="chan_name">Nazwa</label>
        </div>
        <table>
        <thead>
          <caption>Wybierz jedną lub więcej osób:</caption>
        </thead>
        <tbody id="userSelector">

        </tbody>
      </table>
      </div>

    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect waves-red btn-flat">Anuluj</a>
      <a class="modal-close waves-effect waves-green btn-flat" onclick="createChannel()">Utwórz konwersację</a>
    </div>
  </div>
  <div id="editChannel" class="modal modal-fullscreen modal-fixed-footer">
    <div class="modal-content">
      <h4>Ustawienia konwersacji</h4>
      <div class="row">
        <div class="input-field col s9">

          <i class="material-icons prefix">edit_mode</i>
          <input required id="chan_edit_name" type="text" class="validate">
          <label for="chan_name">Nazwa</label>
        </div>
        <div class="col s3">
          <button class="btn waves-effect yellow accent-2 black-text" onclick="renameChannel()">Zmień</button>
        </div>
        </div>
        <table>
        <thead>
          <caption>Członkowie (kliknij osobę, aby zobaczyć profil):</caption>
          <tr>
            <th>Użytkownik</th>
            <th>Uprawnienia</th>
          </tr>
        </thead>
        <tbody id="userManager">

        </tbody>
      </table>
      

    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect waves-grey btn-flat">Zamknij</a>
    </div>
  </div>
  <div id="userInfo" class="modal bottom-sheet">
    <div class="modal-content">
      <img id="userInfoAvatar" class="circle small_logo"><span id="userInfoNick"></span>
      <p id="userInfoActivity"></p>
      <p id="userInfoReputation"></p>
      <p id="userInfoSent"></p>
      <p id="userInfoSelfDeleted"></p>
      <p id="userInfoAdminDeleted"></p>
      <p id="userInfoUid" class="grey-text"></p>
    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect waves-teal btn-flat">Zamknij</a>
    </div>
  </div>
  <div id="messageActions" class="modal bottom-sheet">
    <div class="modal-content">
      <button class="btn green waves-effect" id="upvote"><i class="material-icons">thumb_up</i></button>
      <span id="votes"></span>
      <button class="btn orange waves-effect" id="downvote"><i class="material-icons">thumb_down</i></button>
      <p id="yourVote"></p>
      <button class="btn waves-effect btn-flat grey" id="voteBack"><i class="material-icons">undo</i> Cofnij moją reakcję</button>
      <br/><br/>
      <button class="btn waves-effect btn-flat red" id="deleteMessage"><i class="material-icons">delete</i> Usuń dla wszystkich</button>
    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect waves-teal btn-flat">Anuluj</a>
    </div>
  </div>
  <div id="ranking" class="modal modal-fixed-footer">
    <div class="modal-content">
      <h4>Ranking Użytkowników</h4>
      <table class="centered highlight">
        <thead>
          <tr>
              <th>Miejsce</th>
              <th>Nick</th>
              <th>Reputacja</th>
          </tr>
        </thead>

        <tbody id="rankingBody">
          
        </tbody>
      </table>
    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect btn-flat">Zamknij</a>
    </div>
  </div>
  <div id="settings" class="modal modal-fixed-footer modal-fullscreen">
    <div class="modal-content">
      <h4>Ustawienia</h4>
    <p>Nick: <span id="settingsNick"></span><a class="btn-flat blue-text modal-trigger" href="#editNick"><i class="material-icons left">edit</i></a></p>
    <p>Awatar: <br/><img id="settingsAvatar" class="circle small_logo" /><a class="btn-flat blue-text modal-trigger" href="#uploadAvatar"><i class="material-icons left">cloud_upload</i></a><a class="btn-flat red-text modal-trigger" href="#resetAvatar"><i class="material-icons left">clear</i></a></p>
    <p>Adres e-mail: <span id="settingsEmail"></span><a class="btn-flat blue-text modal-trigger" href="#editEmail"><i class="material-icons left">edit</i></a></p>
    <a class="btn blue modal-trigger" href="#changePassword"><i class="material-icons left">lock</i> Zmień hasło</a><a class="btn red modal-trigger" href="#confirmDeleteAccount"><i class="material-icons left">delete</i> Usuń konto</a>
    </div>
    
    <div class="modal-footer">
      <a class="waves-effect waves-teal btn-flat modal-trigger" href="#userInfo" onclick="getMyInfo()">Podgląd profilu</a>
      <a class="modal-close waves-effect waves-grey btn-flat">Zamknij</a>
    </div>
  </div>
  <div id="editNick" class="modal bottom-sheet">
    <div class="modal-content">
      <h4>Zmiana nicku</h4>
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">perm_identity</i>
          <input required id="edit_nick" type="text" class="validate">
          <label for="edit_nick">Nowy nick</label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect waves-red btn-flat">Anuluj</a>
      <a class="modal-close waves-effect waves-green btn-flat" onclick="changeNick()">Zapisz</a>
    </div>
  </div>
  <div id="editEmail" class="modal bottom-sheet">
    <div class="modal-content">
      <h4>Zmiana adresu e-mail</h4>
      <div class="row">
        <p>W trosce o Twoje bezpieczeństwo wymagane jest podanie hasła.</p>
      	<div class="input-field col s12">
          <i class="material-icons prefix">lock</i>
          <input required id="edit_email_password" type="password" class="validate">
          <label for="edit_email">Twoje hasło</label>
        </div>
        <div class="input-field col s12">
          <i class="material-icons prefix">email</i>
          <input required id="edit_email" type="email" class="validate">
          <label for="edit_email">Nowy adres e-mail</label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect waves-red btn-flat">Anuluj</a>
      <a class="modal-close waves-effect waves-green btn-flat" onclick="changeEmail()">Zapisz</a>
    </div>
  </div>
  <div id="uploadAvatar" class="modal bottom-sheet">
    <div class="modal-content">
      <h4>Zmiana zdjęcia profilowego</h4>
      <div class="file-field input-field">
      <div class="btn">
        <span><i class="material-icons">cloud_upload</i> Prześlij awatar</span>
        <input type="file" id="upload_avatar">
      </div>
      <div class="file-path-wrapper">
        <input class="file-path validate" type="text" placeholder="Nie wybrano pliku.">
      </div>
    </div>
    <div class="progress">
      <div class="determinate" id="upload_avatar_progress"></div>
  </div>
  <p id="upload_avatar_state"></p>
    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect waves-red btn-flat">Anuluj</a>
      <a class="waves-effect waves-green btn-flat" onclick="changeAvatar()">Prześlij</a>
    </div>
  </div>
  <div id="resetAvatar" class="modal bottom-sheet">
    <div class="modal-content">
      <h4>Przywrócić domyślny awatar?</h4>
    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect waves-grey btn-flat">Anuluj</a>
      <a class="waves-effect waves-orange btn-flat" onclick="resetAvatar()">Przywróć domyślny awatar</a>
    </div>
  </div>
  <div id="changePassword" class="modal bottom-sheet">
    <div class="modal-content">
      <h4>Zmiana hasła do konta</h4>
      <div class="row">
      	<div class="input-field col s12">
          <i class="material-icons prefix">lock_open</i>
          <input required id="old_password" type="password" class="validate">
          <label for="edit_email">Stare hasło</label>
        </div>
        <div class="input-field col s12">
          <i class="material-icons prefix">lock</i>
          <input required id="new_password" type="password" class="validate">
          <label for="edit_email">Nowe hasło</label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect waves-red btn-flat">Anuluj</a>
      <a class="modal-close waves-effect waves-green btn-flat" onclick="changePassword()">Zapisz</a>
    </div>
  </div>
  <div id="confirmDeleteAccount" class="modal bottom-sheet">
    <div class="modal-content">
      <h4>Usuwanie konta</h4>
      <p class="red-text">Tej operacji nie można cofnąć.</p>
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">lock</i>
          <input required id="delete_account_password" type="password" class="validate">
          <label for="edit_email">Hasło</label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <a class="modal-close waves-effect waves-red btn-flat">Anuluj</a>
      <a class="modal-close waves-effect waves-green btn-flat red-text" onclick="deleteAccount()">Usuń moje konto</a>
    </div>
  </div>
</body>


<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/6.2.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.2/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.2/firebase-storage.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.2/firebase-messaging.js"></script>
<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#config-web-app -->
<script src="https://cdn.tiny.cloud/1/6hqbfqbkupp38gqwmij0rn6amr3ozohz3wcsdi5wb8tfdrok/tinymce/5/tinymce.min.js"></script>
<script src="main.js"></script>
</html>
